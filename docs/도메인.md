## 유저 도메인

### **사용자 관리 및 인증 기능**

**구성요소**

- 사용자(user) 데이터는 아래 요소들이 필수적으로 필요합니다.
    - 이메일(string)
    - 패스워드(string)
    - 이름(string)
    - 생성일시(timestampz)
    - 권한(string): 각 사용자는 멤버(`member`) 또는 관리자(`admin`)의 역할을 가집니다.

**구현 기능**

- 회원 가입
    - 가입 시 받아야 할 필수 정보: 이메일, 패스워드, 이름
- 로그인
    - 로그인 시 받아야 할 필수 정보: 이메일, 패스워드
    - 로그인 완료 시 JWT(JSON Web Tokens) 형식의 토큰이 발급됩니다
- 인증
    - -회원가입 및 로그인을 제외한 모든 요청은 JWT 토큰을 확인하여 인증합니다.


---

## 도메인 모델

### User

- 상태
  - 이메일(string)
  - 패스워드(string)
  - 이름(string)
  - 생성일시(timestampz)
  - 권한(string): 각 사용자는 멤버(`member`) 또는 관리자(`admin`)의 역할을 가집니다.

- 행동
  - 회원 가입
    - 이메일, 패스워드, 이름을 입력받아 새로운 사용자를 생성합니다.
  - 로그인
    - 로그인 시 받아야 할 필수 정보: 이메일, 패스워드
    - 로그인 완료 시 JWT(JSON Web Tokens) 형식의 토큰이 발급됩니다
- 제약
  - 회원가입시 최소한의 보안 요소인 패스워드 해싱을 진행한다.
  - 회원가입 입력시 이메일 형식을 검증한다.
  - 일단 빠른 개발을 위해 accesstoken 으로만 구현한다.


---

## 대화 도메인

### **대화(chat) 관리 기능**

**구성 요소**

- 대화(chat) 데이터는 아래 요소들이 필수적으로 필요합니다.
  - 질문(string)
  - 답변(string)
  - 생성일시(timestampz)
- 스레드(thread)
  - 응답 생성을 위해 OpenAI에 요청을 전송할 때 지난 대화(chat) 목록을 함께 보내게 됩니다. 이 목록 단위를 `스레드`라고 정의합니다.
  - 스레드는 각 유저마다 여러 개를 생성할 수 있습니다. (스레드:회원 = N:1 관계)
  - 스레드 생성 시점
    - 해당 유저의 첫 질문이거나, 마지막 질문 후 30분이 지난 시점에 질문할 경우 생성합니다.
    - 해당 유저가 마지막 질문으로부터 30분 이내에 다시 질문할 경우 기존 스레드가 유지됩니다.

**구현 기능**

- 대화 생성
  - 질문을 입력받고 생성된 답변을 응답합니다.
  - 추가 옵션을 파라미터로 받을 수 있습니다
    - isStreaming(boolean): `true` 설정될 경우 stream 형태로 응답합니다.
    - model(string): 설정될 경우 해당 모델로 응답을 생성합니다.
- 대화 목록 조회
  - 요청한 유저의 모든 대화를 응답하는 기능입니다.
  - 스레드 단위로 그룹화된 대화의 목록을 응답해야 합니다.
  - 각 유저는 자신이 생성한 스레드와 대화만 조회할 수 있으며, 관리자는 모든 스레드와 대화를 조회할 수 있습니다.
  - 생성일시 기준으로 오름차순/내림차순 정렬이 가능하며 페이지네이션이 가능해야 합니다.
- 스레드 삭제
  - 특정 스레드를 선택하여 삭제하는 기능입니다.
  - 각 유저는 자신이 생성한 스레드만 삭제 가능합니다.

  
---

## 대화 도메인 모델

### ChatThread

- 상태
  - User:user (N:1)
- 행위
  - 생성
    - 
### Chat

- 상태
  - 질문(string)
  - 답변(string)
  - 생성일시(timestampz)
  - 스레드 ID(string): 해당 대화가 속한 스레드의 ID입니다.

### AIClient
_interface_

- 질문을 받고 답변을 생성하는 Client API에게 요청을 보내는 API 연동 인터페이스
- AIClient 는 아직 선정된게 없다고 가정
- 확장성을 고려한다는 가정
